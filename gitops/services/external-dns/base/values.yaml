# Default values for external-dns.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# https://github.com/kubernetes-sigs/external-dns/tree/master/charts/external-dns

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 256Mi

logLevel: info
logFormat: text

sources:
  - service
  - ingress
  - traefik-proxy

interval: 1m

policy: sync

registry: txt
txtOwnerId: $(configmap:argocd/cluster-config#cluster_name)
txtPrefix: $(configmap:argocd/cluster-config#cluster_name)_

domainFilters:
  - $(configmap:argocd/cluster-config#rootDNSZoneName)

provider:
  name: cloudflare

env:
  - name: CF_API_TOKEN
    valueFrom:
      secretKeyRef:
        name: cloudflare-auth
        key: apiToken

extraArgs:
  - --traefik-disable-legacy
  # - --cloudflare-proxied                   # (optional) enable the proxy feature of Cloudflare (DDOS protection, CDN...)
  - --cloudflare-dns-records-per-page=500   # (optional) configure how many DNS records to fetch per request
  # - --cloudflare-region-key="eu"
  # - --exclude-record-types=AAAA             # Issue: https://github.com/kubernetes-sigs/external-dns/pull/5226
