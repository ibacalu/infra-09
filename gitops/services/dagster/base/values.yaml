ingress:
  enabled: true
  apiVersion: "networking.k8s.io/v1/Ingress"
  ingressClassName: nginx
  annotations:
    cert-manager.io/cluster-issuer: "$(configmap:argocd/cluster-config#cluster-issuer)"
  dagsterWebserver:
    host: "dagster.$(configmap:argocd/cluster-config#clusterDNSZoneName)"
    path: "/"
    pathType: Prefix
    tls:
      enabled: true
      secretName: dagster-tls
  flower:
    host: "flower.$(configmap:argocd/cluster-config#clusterDNSZoneName)"
    path: "/"
    pathType: Prefix
    tls:
      enabled: true
      secretName: dagster-flower-tls

dagsterWebserver:
  nodeSelector:
    kubernetes.io/arch: amd64
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

dagsterDaemon:
  nodeSelector:
    kubernetes.io/arch: amd64
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

postgresql:
  enabled: false

rabbitmq:
  enabled: false

redis:
  enabled: false

flower:
  enabled: false

telemetry:
  enabled: false

# -----------------------------------------------------------------------------
# Run Launcher Configuration
# Enable KSM-based alerting by having K8s Jobs reflect pipeline status
# -----------------------------------------------------------------------------
runLauncher:
  config:
    k8sRunLauncher:
      # When true, the K8s Job/Pod exits with non-zero if the pipeline fails.
      # This allows kube_job_status_failed metric to detect failures.
      failPodOnRunFailure: true
      runK8sConfig:
        jobSpecConfig:
          # Keep completed Jobs for 10 minutes so Prometheus can scrape metrics.
          # Without this, Jobs are deleted immediately and metrics are lost.
          ttlSecondsAfterFinished: 600

    celeryK8sRunLauncher:
      # Same settings for Celery-based execution
      failPodOnRunFailure: true
      runK8sConfig:
        jobSpecConfig:
          ttlSecondsAfterFinished: 600
